<div class="breadcrumb-custom">
  <i class="fa fa-barcode"></i> Planilha
  <span class="location" style="float: right;">Home > Produtos > Planilha</span>
</div>

<div class="container">

  <?php echo (isset($this->alert) ? $this->alert : ''); ?>

  <div class="row">
    <div class="table-responsive">

      <table class="table table-striped table-condensed table-bordered table-prod"
      		style="border-collapse: collapse; width: 100%; overflow-x: auto; display: block; overflow-y: scroll;">
        <thead style="display: block;">
        	<tr>
        	  <form action="<?php echo BASE . 'produtos/inserirDadosPlanilha/'; ?>" method="post" accept-charset="utf-8">

        	  <input type="hidden" name="total_colunas" value="<?php echo $view_colunas; ?>">
        	  <input type="hidden" name="total_linhas" value="<?php echo $view_linhas; ?>">

        	  <?php for ($i=0; $i < $view_colunas; $i++): ?>
        		<td style="min-width: 150px; height: 25px; width: 20%;">
        			<select name="<?php echo 'select'. $i; ?>" class="form-control">
        			  <option value="none">Não importar coluna</option>
        			  <option value="descricao">Descrição *</option>
        			  <option value="codigo_interno">Código</option>
        			  <option value="custo">Custo</option>
        			  <option value="valor_venda">Valor de Venda *</option>
        			  <option value="estoque_atual">Estoque *</option>
        			  <option value="estoque_minimo">Est. Mínimo *</option>
        			  <option value="estoque_maximo">Est. Máximo</option>        			  
        			</select>
        		</td>
        	  <?php endfor; ?>       	  	
        	  
        	</tr>
        	<tr>
	          <?php foreach ($view_titulo as $linha) : ?>
				<th class="text-center" style="min-width: 150px; height: 25px; width: 20%;">
					<b><?php echo $linha; ?></b>
				</th>
	          <?php endforeach; ?>
			</tr>
        </thead>
      </table>
      
      <table class="table table-striped table-condensed table-bordered table-prod"
      		style="border-collapse: collapse; width: 100%; overflow-x: hidden; display: block;">
        <tbody style="display: block; overflow-y: auto; overflow-x: auto; height: 250px;">
          <?php 
            if ($view_dados) :
              $coluna = 0; ## Setando coluna
              $linhas = 0;
              $matrizOriginal = array();

              foreach ($view_dados as $linha) :
          ?>
              <tr>
              	<?php while ($coluna < $view_colunas): ?>
                	<td class="text-center" style="min-width: 150px; height: 25px; width: 20%;">
		            	<?php echo $linha[$coluna]; ?>
		            	<?php $matrizOriginal[$linhas][$coluna] = $linha[$coluna]; ?>
                	</td>
            	<?php $coluna++; ?>
            	<?php endwhile; ?>
              </tr>
        	<?php $linhas++; ?>
          <?php
          	  if ($coluna == $view_colunas)
          	  	 $coluna = 0; ## Se chegar na ultima coluna zera.
              endforeach;
              $this->session->set('dadosPlanilha', $matrizOriginal); //Criando sessão com array de dados
          ?>
          <?php endif; ?>
        </tbody>
      </table>  
    </div>
  </div>

  <div class="row">
  	<a href="<?php $this->printRelativeURL('listar', true); ?>" class="btn btn-danger">Cancelar</a>
  	<button type="submit" class="btn btn-success">Salvar</button>
  </div>

 </form>
 </div>
 
 <!-- Script de Scrolling da tabela -->
 <script type="text/javascript">
 	$(document).ready(function() {
		$('table').on('scroll', function() {
		    $("table > *").width($("table").width() + $("table").scrollLeft());
		}); 
	});
 </script>